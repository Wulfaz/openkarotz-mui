/*! openkarotz-js v0.3.1 | (c) 2013 Olivier Bagot | opensource.org/licenses/MIT
 * http://github.com/hobbe/openkarotz-js
 */
"use strict";var OpenKarotz=function(e){function k(e,t,n){console.log("Calling: "+e);$.get(e,function(r){console.log(e+" result: "+r);var i=JSON.parse(r);if(i["return"]==0){if(t){t(i)}}else{if(n){n(i.msg)}}})}if(e===undefined){console.log("variable karotz_ip is required!");throw new Error("variable karotz_ip is required!")}this.WHITE="FFFFFF";this.BLACK="000000";this.RED="FF0000";this.GREEN="00FF00";this.BLUE="0000FF";this.VIOLET="660099";this.CYAN="00FFFF";this.YELLOW="FFFF00";this.PINK="FF00CB";this.ORANGE="FF9900";this.ip=e;this.state={sleep:1,version:"unknown",karotz_free_space:"unknown"};var t="http://"+e;var n=t+"/cgi-bin";var r=n+"/status";var i=n+"/sleep";var s=n+"/wakeup";var o=n+"/reboot";var u=n+"/sound";var a=n+"/sound_control";var f=n+"/leds";var l=n+"/ears";var c=n+"/ears_reset";var h=n+"/ears_random";var p=n+"/tts";var d=n+"/snapshot";var v=n+"/snapshot_get";var m=n+"/snapshot_list";var g=n+"/clear_snapshots";var y=n+"/clear_cache";var b=n+"/rfid_info";var w=n+"/rfid_list";var E=n+"/rfid_list_ext";var S=n+"/rfid_delete";var x=n+"/rfid_start_record";var T=n+"/rfid_stop_record";var N=n+"/moods_list";var C=n+"/apps/moods";this.getIp=function(){return this.ip};this.getUrl=function(){return t};this.getApiUrl=function(){return n};this.getState=function(){return this.state};this.status=function(e,t){var n=r;var i=this;console.log("Calling: "+n);$.get(n,function(r){console.log(n+" result: "+r);if(r){var s=JSON.parse(r);i.state=s;console.log(i.state);if(e){e(s)}}else{i.state.sleep=1;if(t){t("rabbit is offline")}}})};this.sleep=function(e,t){var n=this;var r=i;k(r,function(){n.state.sleep=1;e()},t)};this.wakeup=function(e,t){var n=this;var r=s;k(r,function(){n.state.sleep=0;e()},t)};this.reboot=function(e,t){var n=o;k(n,e,t)};this.sound=function(e,t,n){var r=u+"?url="+e;k(r,t,n)};this.soundInternal=function(e,t,n){var r=u+"?id="+e;k(r,t,n)};this.soundControl=function(e,t,n){var r=a+"?cmd="+e;k(r,t,n)};this.soundControlPause=function(e,t){this.soundControl("pause",e,t)};this.soundControlQuit=function(e,t){this.soundControl("quit",e,t)};this.leds=function(e,t,n,r){var i="?";if(t&&t==true){i+="pulse=1&"}var s=f+i+"color="+e;k(s,n,r)};this.ledsPulse=function(e,t,n){this.leds(e,true,t,n)};this.ledsFixed=function(e,t,n){this.leds(e,false,t,n)};this.ears=function(e,t,n,r){var i=l+"?left="+e+"&right="+t;k(i,n,r)};this.earsReset=function(e,t){var n=c;k(n,e,t)};this.earsRandom=function(e,t){var n=h;k(n,e,t)};this.moods=function(e,t,n){var r="";if(e){r+="?id="+e}var i=C+r;k(i,t,n)};this.tts=function(e,t,n,r,i){var s='?text="Bonjour"';if(e){s='?text="'+encodeURIComponent(e.replace(new RegExp("'","g"),""))+'"'}var o="&voice=margaux";if(t){o="&voice="+encodeURIComponent(t)}var u="&nocache=0";if(n&&n==true){u="&nocache=1"}var a=p+s+o+u;k(a,r,i)};this.snapshot=function(e,t,n){var r="?silent=0";if(e&&e==true){r="?silent=1"}var i=d+r;k(i,t,n)};this.getSnapshotUrl=function(e){var t=v+"?filename="+e;console.log("getSnapshotUrl: "+t);return t};this.getSnapshotThumbnailUrl=function(e){var t=e.replace(".jpg",".thumb.gif");var n=v+"?filename="+t;console.log("getSnapshotThumbnailUrl: "+n);return n};this.snapshotList=function(e,t){var n=m;k(n,e,t)};this.clearSnapshots=function(e,t){var n=g;k(n,e,t)};this.clearCache=function(e,t){var n=y;k(n,e,t)};this.rfidInfo=function(e,t,n){var r=b+"?tag="+encodeURIComponent(e);k(r,t,n)};this.rfidList=function(e,t){var n=w;k(n,e,t)};this.rfidListExt=function(e,t){var n=E;k(n,e,t)};this.rfidDelete=function(e,t,n){var r=S+"?tag="+encodeURIComponent(e);k(r,t,n)};this.rfidStartRecord=function(e,t){var n=x;k(n,e,t)};this.rfidStopRecord=function(e,t){var n=T;k(n,e,t)};this.moodsList=function(e,t){var n=N;k(n,e,t)};return this}