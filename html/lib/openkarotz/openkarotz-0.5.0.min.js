/*! openkarotz-js v0.5.0 | (c) 2023 Lionel Caillis | opensource.org/licenses/MIT
 * http://github.com/wulfaz/openkarotz-js
 */
"use strict";var OpenKarotz=function(t){this.WHITE="FFFFFF",this.BLACK="000000",this.RED="FF0000",this.GREEN="00FF00",this.BLUE="0000FF",this.VIOLET="660099",this.CYAN="00FFFF",this.YELLOW="FFFF00",this.PINK="FF00CB",this.ORANGE="FF9900",this.ip=t,this.state={sleep:1,version:"unknown",karotz_free_space:"unknown"};var n=t?"http://"+t:"",s=n+"/cgi-bin",o=s+"/status",i=s+"/sleep",e=s+"/wakeup",r=s+"/reboot",u=s+"/sound",c=s+"/sound_control",h=s+"/leds",a=s+"/ears",l=s+"/ears_reset",f=s+"/ears_random",d=s+"/tts",p=s+"/snapshot",g=s+"/snapshot_get",F=s+"/snapshot_list",_=s+"/clear_snapshots",m=s+"/clear_cache",C=s+"/rfid_info",R=s+"/rfid_list",U=s+"/rfid_list_ext",v=s+"/rfid_delete",E=s+"/rfid_start_record",I=s+"/rfid_stop_record",S=s+"/moods_list",L=s+"/apps/moods";function b(n,s,i){console.log("Calling: "+n),$.get(n,function(t){console.log(n+" result: "+t);t=JSON.parse(t);0==t.return?s&&s(t):i&&i(t.msg)})}return this.getIp=function(){return this.ip},this.getUrl=function(){return n},this.getApiUrl=function(){return s},this.getState=function(){return this.state},this.status=function(n,s){var i=this;console.log("Calling: "+o),$.get(o,function(t){console.log(o+" result: "+t),t?(t=JSON.parse(t),i.state=t,console.log(i.state),n&&n(t)):(i.state.sleep=1,s&&s("rabbit is offline"))})},this.sleep=function(t,n){var s=this;b(i,function(){s.state.sleep=1,t()},n)},this.wakeup=function(t,n,s){var i="";t&&!0===t&&(i="?silent=1");var o=this;b(e+i,function(){o.state.sleep=0,n()},s)},this.reboot=function(t,n){b(r,t,n)},this.sound=function(t,n,s){b(u+("?url="+t),n,s)},this.soundInternal=function(t,n,s){b(u+("?id="+t),n,s)},this.soundControl=function(t,n,s){b(c+("?cmd="+t),n,s)},this.soundControlPause=function(t,n){this.soundControl("pause",t,n)},this.soundControlQuit=function(t,n){this.soundControl("quit",t,n)},this.leds=function(t,n,s,i){t="?color="+t;n&&!0===n&&(t+="&pulse=1"),b(h+t,s,i)},this.ledsPulse=function(t,n,s){this.leds(t,!0,n,s)},this.ledsFixed=function(t,n,s){this.leds(t,!1,n,s)},this.ears=function(t,n,s,i,o){n="?left="+t+"&right="+n;s&&!0===s&&(n+="&noreset=1"),b(a+n,i,o)},this.earsReset=function(t,n){b(l,t,n)},this.earsRandom=function(t,n){b(f,t,n)},this.moods=function(t,n,s){b(L+(t?"?id="+t:""),n,s)},this.tts=function(t,n,s,i,o){var e='?text="Bonjour"';t&&(e='?text="'+encodeURIComponent(t.replace(new RegExp("'","g"),""))+'"'),e+=n?"&voice="+encodeURIComponent(n):"&voice=margaux",b(d+(e+=s&&!0===s?"&nocache=1":"&nocache=0"),i,o)},this.snapshot=function(t,n,s){b(p+(t&&!0===t?"?silent=1":"?silent=0"),n,s)},this.getSnapshotUrl=function(t){t=g+"?filename="+t;return console.log("getSnapshotUrl: "+t),t},this.getSnapshotThumbnailUrl=function(t){t=t.replace(".jpg",".thumb.gif"),t=g+"?filename="+t;return console.log("getSnapshotThumbnailUrl: "+t),t},this.snapshotList=function(t,n){b(F,t,n)},this.clearSnapshots=function(t,n){b(_,t,n)},this.clearCache=function(t,n){b(m,t,n)},this.rfidInfo=function(t,n,s){t="?tag="+encodeURIComponent(t);b(C+t,n,s)},this.rfidList=function(t,n){b(R,t,n)},this.rfidListExt=function(t,n){b(U,t,n)},this.rfidDelete=function(t,n,s){t="?tag="+encodeURIComponent(t);b(v+t,n,s)},this.rfidStartRecord=function(t,n){b(E,t,n)},this.rfidStopRecord=function(t,n){b(I,t,n)},this.moodsList=function(t,n){b(S,t,n)},this};